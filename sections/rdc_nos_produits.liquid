{% schema %}
{
  "name": "RDC - Nos Produits",
  "tag": "section",
  "class": "rdc-nos-produits-section",
  "settings": [
    {
      "type": "select",
      "id": "width",
      "label": "Largeur de la section",
      "options": [
        { "value": "container", "label": "Container" },
        { "value": "stretched", "label": "Stretched" },
        { "value": "full", "label": "Full Width" }
      ],
      "default": "container"
    },
    {
      "type": "select",
      "id": "heading_tag",
      "label": "Taille du titre (balise HTML)",
      "options": [
        { "value": "h1", "label": "Heading 1" },
        { "value": "h2", "label": "Heading 2" },
        { "value": "h3", "label": "Heading 3" },
        { "value": "h4", "label": "Heading 4" },
        { "value": "h5", "label": "Heading 5" },
        { "value": "h6", "label": "Heading 6" }
      ],
      "default": "h1"
    },
    {
      "type": "text",
      "id": "heading_text",
      "label": "Texte du titre",
      "default": "Nos collections"
    },
    {
      "type": "richtext",
      "id": "description_text",
      "label": "Description sous le titre",
      "default": "<p>Insérer une description</p>"
    },
    {
      "type": "text",
      "id": "description_button_text",
      "label": "Texte du bouton de la description",
      "default": "Découvrir"
    },
    {
      "type": "url",
      "id": "description_button_link",
      "label": "Lien du bouton de la description"
    },
    {
      "type": "select",
      "id": "description_button_style",
      "label": "Style du bouton de la description",
      "options": [
        { "value": "primary", "label": "Primaire" },
        { "value": "outline", "label": "Outline" },
        { "value": "secondary", "label": "Secondaire" }
      ],
      "default": "primary"
    },
    {
      "type": "select",
      "id": "content_orientation",
      "label": "Alignement du titre et de la description",
      "options": [
        { "value": "vertical", "label": "Vertical (centré)" },
        { "value": "horizontal", "label": "Horizontal (à gauche)" }
      ],
      "default": "vertical"
    }
  ],
  "blocks": [
    {
      "type": "mini_block",
      "name": "Mini Image & Texte",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" },
        {
          "type": "select",
          "id": "image_position",
          "label": "Position de l'image",
          "options": [
            { "value": "left", "label": "Gauche" },
            { "value": "right", "label": "Droite" }
          ],
          "default": "left"
        },
        {
          "type": "select",
          "id": "vertical_alignment",
          "label": "Alignement vertical",
          "options": [
            { "value": "top", "label": "Haut" },
            { "value": "middle", "label": "Milieu" },
            { "value": "bottom", "label": "Bas" }
          ],
          "default": "middle"
        },
        {
          "type": "select",
          "id": "text_alignment",
          "label": "Alignement du texte",
          "options": [
            { "value": "left", "label": "Gauche" },
            { "value": "center", "label": "Centré" },
            { "value": "right", "label": "Droite" }
          ],
          "default": "left"
        },
        {
          "type": "range",
          "id": "padding_top",
          "label": "Marge haute (px)",
          "min": 0,
          "max": 100,
          "step": 5,
          "default": 40
        },
        {
          "type": "range",
          "id": "padding_bottom",
          "label": "Marge basse (px)",
          "min": 0,
          "max": 100,
          "step": 5,
          "default": 40
        },
        {
          "type": "range",
          "id": "image_width",
          "label": "Largeur de l'image (%)",
          "min": 20,
          "max": 80,
          "step": 5,
          "default": 50
        },
        {
          "type": "select",
          "id": "image_format",
          "label": "Format de l'image",
          "options": [
            { "value": "auto", "label": "Automatique" },
            { "value": "square", "label": "Carré" },
            { "value": "landscape", "label": "Paysage (16:9)" },
            { "value": "portrait", "label": "Portrait (3:4)" }
          ],
          "default": "auto"
        },
        { "type": "text", "id": "title", "label": "Titre", "default": "Image with text" },
        { "type": "richtext", "id": "text", "label": "Texte", "default": "<p>Pair text with an image to focus on your chosen product, collection, or blog post. Add details on availability, style, or even provide a review.</p>" },
        { "type": "text", "id": "button_text", "label": "Texte du bouton", "default": "button text" },
        { "type": "url", "id": "button_link", "label": "Lien du bouton" },
        {
          "type": "select",
          "id": "button_style",
          "label": "Style du bouton",
          "options": [
            { "value": "primary", "label": "Primaire" },
            { "value": "outline", "label": "Outline" },
            { "value": "secondary", "label": "Secondaire" }
          ],
          "default": "primary"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "RDC - Nos Produits",
      "blocks": [
        { "type": "mini_block" }
      ]
    }
  ]
}
{% endschema %}

{%- comment -%}
Affichage du titre et de la description de la section (par défaut)
{%- endcomment -%}
<{{ section.settings.heading_tag }} class="section-title">
  {{ section.settings.heading_text }}
</{{ section.settings.heading_tag }}>

<div class="section-description">
  {{ section.settings.description_text }}
</div>

{%- comment -%}
Render du bouton dans la description
{%- endcomment -%}
{% if section.settings.description_button_text != blank %}
  <div class="button-wrapper">
    {% render 'button', 
      button_text: section.settings.description_button_text, 
      button_url: section.settings.description_button_link | default: '#', 
      button_style: section.settings.description_button_style | default: 'primary' %}
  </div>
{% endif %}

{%- comment -%}
Render des mini-blocks avec image uniquement si elle est définie, sinon rien
{%- endcomment -%}
{% for block in section.blocks %}
  {% if block.type == 'mini_block' %}
    <div class="mini-block" style="padding-top: {{ block.settings.padding_top }}px; padding-bottom: {{ block.settings.padding_bottom }}px;">
      
      <div class="mini-block-content" style="display: flex; flex-direction: {% if block.settings.image_position == 'left' %}row{% else %}row-reverse{% endif %}; align-items: {{ block.settings.vertical_alignment }};">
        
        {% if block.settings.image != blank %}
          <div class="mini-block-image" style="flex: 0 0 {{ block.settings.image_width }}%;">
            <img 
              src="{{ block.settings.image | img_url: 'master' }}" 
              alt="{{ block.settings.title | escape }}" 
              class="image-{{ block.settings.image_format }}">
          </div>
        {% endif %}
        
        <div class="mini-block-text" style="flex: 1; text-align: {{ block.settings.text_alignment }};">
          <h3>{{ block.settings.title }}</h3>
          <div class="rich-text">
            {{ block.settings.text }}
          </div>

          {% if block.settings.button_text != blank %}
            <div class="button-wrapper" style="margin-top: 1em;">
              {% render 'button', 
                button_text: block.settings.button_text, 
                button_url: block.settings.button_link | default: '#', 
                button_style: block.settings.button_style | default: 'primary' %}
            </div>
          {% endif %}

        </div>

      </div>

    </div>
  {% endif %}
{% endfor %}



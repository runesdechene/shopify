<!-- render 'rdc_hiding_disabled_variants'  in main-product.liquid -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  // Fonction pour masquer les variantes indisponibles
  function hideUnavailableVariants() {
    // Sélectionner tous les inputs de couleur
    const colorInputs = document.querySelectorAll(
      '.swatch-input__input[name="Couleur"]'
    );
    colorInputs.forEach((input) => {
      const color = input.value;
      const label = document.querySelector(`label[for="${input.id}"]`);

      // Vérifier si l'input est déjà désactivé (variante épuisée)
      if (input.classList.contains("visually-disabled") || input.disabled) {
        // Appliquer les styles au label (le cercle de couleur)
        if (label) {
          label.style.display = "none";
        }
      }
    });

    // Sélectionner tous les boutons de taille
    const sizeInputs = document.querySelectorAll('input[name="Taille"]');
    sizeInputs.forEach((input) => {
      const size = input.value;
      const label = document.querySelector(`label[for="${input.id}"]`);

      // Vérifier si l'input est déjà désactivé (variante épuisée)
      if (input.classList.contains("visually-disabled") || input.disabled) {
        if (label) {
          label.style.display = "none";
        }
      }
    });
  }

  // Fonction pour vérifier la disponibilité d'une variante
  function checkVariantAvailability(optionType, value) {
    try {
      // Récupérer toutes les variantes du produit
      const variants = window.product ? window.product.variants : [];

      // Vérifier si au moins une variante avec cette option est disponible
      return variants.some((variant) => {
        const hasOption = variant.options.some((opt) => opt === value);
        return hasOption && variant.available;
      });
    } catch (error) {
      console.error("Erreur lors de la vérification de disponibilité:", error);
      return true; // En cas d'erreur, on n'applique pas de restriction
    }
  }

  // Exécuter au chargement
  hideUnavailableVariants();

  // Réexécuter lors des changements de variante
  document.addEventListener("variant:change", hideUnavailableVariants);
});

</script>